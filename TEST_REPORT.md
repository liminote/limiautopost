# Threads åŠŸèƒ½æ¸¬è©¦å ±å‘Š

## ðŸ“Š æ¸¬è©¦æ¦‚è¦½

- **ç¸½æ¸¬è©¦æ•¸**: 42 å€‹æ¸¬è©¦
- **é€šéŽçŽ‡**: 100% âœ…
- **æ¸¬è©¦æ–‡ä»¶**: 3 å€‹
- **æ¸¬è©¦é¡žåž‹**: å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦

## ðŸ§ª è‡ªå‹•åŒ–æ¸¬è©¦è¦†è“‹ç¯„åœ

### 1. Threads Service æ¸¬è©¦ (`threadsService.test.ts`)
**æ¸¬è©¦æ•¸é‡**: 12 å€‹æ¸¬è©¦

#### âœ… å·²è¦†è“‹åŠŸèƒ½
- **Threads ç‹€æ…‹ç®¡ç†**
  - å·²é€£æŽ¥ç‹€æ…‹è™•ç†
  - æœªé€£æŽ¥ç‹€æ…‹è™•ç†
  - ç‹€æ…‹åŒæ­¥é‚è¼¯

- **Threads æ–·é–‹é€£çµ**
  - æ–·é–‹é€£çµæˆåŠŸè™•ç†
  - æ–·é–‹é€£çµå¤±æ•—è™•ç†
  - ç¶²è·¯éŒ¯èª¤è™•ç†

- **Threads å¼·åˆ¶åŒæ­¥**
  - å¼·åˆ¶åŒæ­¥æˆåŠŸ
  - åŒæ­¥å¤±æ•—è™•ç†

- **localStorage äº‹ä»¶ç›£è½**
  - localStorage è®ŠåŒ–ç›£è½
  - username è®ŠåŒ–è™•ç†

- **é é¢å¯è¦‹æ€§è®ŠåŒ–è™•ç†**
  - é é¢è®Šç‚ºå¯è¦‹
  - é é¢è®Šç‚ºéš±è—

### 2. UserSettings çµ„ä»¶æ¸¬è©¦ (`UserSettings.test.tsx`)
**æ¸¬è©¦æ•¸é‡**: 14 å€‹æ¸¬è©¦

#### âœ… å·²è¦†è“‹åŠŸèƒ½
- **Threads é€£æŽ¥ç‹€æ…‹é¡¯ç¤º**
  - æœªé€£æŽ¥ç‹€æ…‹é¡¯ç¤º
  - å·²é€£æŽ¥ç‹€æ…‹é¡¯ç¤º
  - å·²é€£æŽ¥ä½†ç„¡ username ç‹€æ…‹

- **Threads æ–·é–‹é€£çµåŠŸèƒ½**
  - æ–·é–‹é€£çµæˆåŠŸè™•ç†
  - æ–·é–‹é€£çµå¤±æ•—è™•ç†
  - ç¶²è·¯éŒ¯èª¤è™•ç†

- **Threads å¼·åˆ¶åŒæ­¥åŠŸèƒ½**
  - å¼·åˆ¶åŒæ­¥æˆåŠŸ
  - åŒæ­¥å¤±æ•—è™•ç†

- **Threads è¨ºæ–·åŠŸèƒ½**
  - ç‹€æ…‹è¨ºæ–·é¡¯ç¤º

- **OAuth å›žèª¿è™•ç†**
  - OAuth æˆåŠŸå›žèª¿
  - æ¸…é™¤ OAuth å›žèª¿åƒæ•¸

- **localStorage äº‹ä»¶ç›£è½**
  - localStorage è®ŠåŒ–ç›£è½

- **é é¢å¯è¦‹æ€§è®ŠåŒ–è™•ç†**
  - é é¢å¯è¦‹æ€§è®ŠåŒ–

- **æ¨¡æ¿ç®¡ç†åŠŸèƒ½**
  - æ¨¡æ¿ç®¡ç†ç•Œé¢

### 3. Netlify Functions æ¸¬è©¦ (`threads-functions.test.ts`)
**æ¸¬è©¦æ•¸é‡**: 16 å€‹æ¸¬è©¦

#### âœ… å·²è¦†è“‹åŠŸèƒ½
- **Threads OAuth Start Function**
  - OAuth æŽˆæ¬Š URL ç”Ÿæˆ
  - ç©ºç”¨æˆ¶éƒµç®±è™•ç†

- **Threads OAuth Callback Function**
  - state åƒæ•¸è§£æž
  - ç„¡æ•ˆ state åƒæ•¸è™•ç†
  - ç©º state åƒæ•¸è™•ç†

- **Threads Status Function**
  - ç”¨æˆ¶éš”é›¢ token æŸ¥è©¢
  - ç‹€æ…‹æª¢æŸ¥é‚è¼¯
  - éŒ¯èª¤ç‹€æ…‹è™•ç†

- **Token Store Logic**
  - ç”¨æˆ¶éš”é›¢ token key ç”Ÿæˆ
  - token æ•¸æ“šçµæ§‹è™•ç†

- **API Response Handling**
  - Threads API å›žæ‡‰è™•ç†
  - API éŒ¯èª¤å›žæ‡‰è™•ç†

- **Cookie Handling**
  - ç”¨æˆ¶éš”é›¢ cookie ç”Ÿæˆ
  - ç‰¹æ®Šå­—ç¬¦éƒµç®±è™•ç†

- **Redirect URL Generation**
  - ç”¨æˆ¶ç‰¹å®šé‡å®šå‘ URL ç”Ÿæˆ
  - ç„¡ç”¨æˆ¶éƒµç®±é‡å®šå‘è™•ç†

## ðŸ” éœ€è¦æ‰‹å‹•æ¸¬è©¦çš„éƒ¨åˆ†

### 1. ç«¯åˆ°ç«¯ OAuth æµç¨‹æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: å®Œæ•´çš„ Threads é€£æŽ¥æµç¨‹
**æ¸¬è©¦æ­¥é©Ÿ**:
1. é»žæ“Šã€Œé€£çµ Threadsï¼ˆOAuthï¼‰ã€æŒ‰éˆ•
2. å®Œæˆ Threads æŽˆæ¬Š
3. æª¢æŸ¥æ˜¯å¦æ­£ç¢ºè·³è½‰å›žè¨­å®šé é¢
4. é©—è­‰ç‹€æ…‹é¡¯ç¤ºå’Œ username æ˜¯å¦æ­£ç¢º

**é æœŸçµæžœ**:
- OAuth æµç¨‹æ­£å¸¸å®Œæˆ
- ç‹€æ…‹é¡¯ç¤ºã€Œå·²é€£æŽ¥ã€
- username æ­£ç¢ºé¡¯ç¤º
- æœ¬åœ°å¿«å–æ­£ç¢ºä¿å­˜

### 2. è·¨ç€è¦½å™¨æ¨™ç±¤ç‹€æ…‹åŒæ­¥æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: å¤šæ¨™ç±¤é ç‹€æ…‹åŒæ­¥
**æ¸¬è©¦æ­¥é©Ÿ**:
1. åœ¨æ¨™ç±¤ A ä¸­é€£æŽ¥ Threads
2. åœ¨æ¨™ç±¤ B ä¸­æ‰“é–‹è¨­å®šé é¢
3. æª¢æŸ¥ç‹€æ…‹æ˜¯å¦è‡ªå‹•åŒæ­¥
4. åœ¨æ¨™ç±¤ B ä¸­æ–·é–‹é€£çµ
5. æª¢æŸ¥æ¨™ç±¤ A ä¸­çš„ç‹€æ…‹æ˜¯å¦æ›´æ–°

**é æœŸçµæžœ**:
- å¤šæ¨™ç±¤é ç‹€æ…‹è‡ªå‹•åŒæ­¥
- localStorage è®ŠåŒ–äº‹ä»¶æ­£ç¢ºè§¸ç™¼
- çµ„ä»¶ç‹€æ…‹æ­£ç¢ºæ›´æ–°

### 3. ç¶²è·¯ç•°å¸¸æƒ…æ³æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: ç¶²è·¯ä¸ç©©å®šæ™‚çš„ç‹€æ…‹ç®¡ç†
**æ¸¬è©¦æ­¥é©Ÿ**:
1. é€£æŽ¥ Threads å¾Œï¼Œæ¨¡æ“¬ç¶²è·¯ä¸­æ–·
2. å˜—è©¦æ–·é–‹é€£çµ
3. æª¢æŸ¥éŒ¯èª¤è™•ç†å’Œç”¨æˆ¶æç¤º
4. ç¶²è·¯æ¢å¾©å¾Œæª¢æŸ¥ç‹€æ…‹åŒæ­¥

**é æœŸçµæžœ**:
- ç¶²è·¯éŒ¯èª¤æ™‚é¡¯ç¤ºé©ç•¶çš„éŒ¯èª¤è¨Šæ¯
- éŒ¯èª¤ç‹€æ…‹ä¸æœƒç ´å£žæœ¬åœ°ç‹€æ…‹
- ç¶²è·¯æ¢å¾©å¾Œèƒ½æ­£ç¢ºåŒæ­¥

### 4. ç€è¦½å™¨åˆ·æ–°å’Œé é¢åˆ‡æ›æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: é é¢ç”Ÿå‘½é€±æœŸäº‹ä»¶è™•ç†
**æ¸¬è©¦æ­¥é©Ÿ**:
1. é€£æŽ¥ Threads å¾Œåˆ·æ–°é é¢
2. æª¢æŸ¥ç‹€æ…‹æ˜¯å¦æ­£ç¢ºæ¢å¾©
3. åˆ‡æ›åˆ°å…¶ä»–é é¢å†å›žä¾†
4. æª¢æŸ¥ç‹€æ…‹æ˜¯å¦ä¿æŒ

**é æœŸçµæžœ**:
- é é¢åˆ·æ–°å¾Œç‹€æ…‹æ­£ç¢ºæ¢å¾©
- é é¢åˆ‡æ›å¾Œç‹€æ…‹ä¿æŒ
- localStorage å’Œçµ„ä»¶ç‹€æ…‹ä¸€è‡´

### 5. å¤šç”¨æˆ¶éš”é›¢æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: ä¸åŒç”¨æˆ¶çš„ Threads é€£æŽ¥éš”é›¢
**æ¸¬è©¦æ­¥é©Ÿ**:
1. ä½¿ç”¨ç”¨æˆ¶ A é€£æŽ¥ Threads
2. ç™»å‡ºå¾Œä½¿ç”¨ç”¨æˆ¶ B ç™»å…¥
3. æª¢æŸ¥æ˜¯å¦é¡¯ç¤ºæ­£ç¢ºçš„é€£æŽ¥ç‹€æ…‹
4. å˜—è©¦é€£æŽ¥ Threadsï¼Œæª¢æŸ¥æ˜¯å¦å½±éŸ¿ç”¨æˆ¶ A

**é æœŸçµæžœ**:
- ä¸åŒç”¨æˆ¶çš„ Threads é€£æŽ¥å®Œå…¨éš”é›¢
- ç”¨æˆ¶ A çš„é€£æŽ¥ç‹€æ…‹ä¸å½±éŸ¿ç”¨æˆ¶ B
- token å­˜å„²ä½¿ç”¨æ­£ç¢ºçš„ç”¨æˆ¶å‰ç¶´

### 6. å¼·åˆ¶åŒæ­¥åŠŸèƒ½æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: ç‹€æ…‹ä¸ä¸€è‡´æ™‚çš„å¼·åˆ¶åŒæ­¥
**æ¸¬è©¦æ­¥é©Ÿ**:
1. æ‰‹å‹•ä¿®æ”¹ localStorage ä¸­çš„ç‹€æ…‹
2. é»žæ“Šã€Œå¼·åˆ¶åŒæ­¥ã€æŒ‰éˆ•
3. æª¢æŸ¥æ˜¯å¦å¾žä¼ºæœå™¨åŒæ­¥ç‹€æ…‹
4. é©—è­‰æœ¬åœ°ç‹€æ…‹æ˜¯å¦æ›´æ–°

**é æœŸçµæžœ**:
- å¼·åˆ¶åŒæ­¥èƒ½å¾žä¼ºæœå™¨ç²å–æœ€æ–°ç‹€æ…‹
- æœ¬åœ°ç‹€æ…‹æ­£ç¢ºæ›´æ–°
- ç”¨æˆ¶å¾—åˆ°åŒæ­¥å®Œæˆçš„æç¤º

### 7. è¨ºæ–·åŠŸèƒ½æ¸¬è©¦
**æ¸¬è©¦å ´æ™¯**: ç‹€æ…‹è¨ºæ–·å’Œå•é¡ŒæŽ’æŸ¥
**æ¸¬è©¦æ­¥é©Ÿ**:
1. é»žæ“Šã€Œè¨ºæ–·ç‹€æ…‹ã€æŒ‰éˆ•
2. æª¢æŸ¥è¨ºæ–·ä¿¡æ¯çš„æº–ç¢ºæ€§
3. é©—è­‰è¨ºæ–·ä¿¡æ¯èˆ‡å¯¦éš›ç‹€æ…‹ä¸€è‡´
4. æ¸¬è©¦ä¸åŒç‹€æ…‹ä¸‹çš„è¨ºæ–·çµæžœ

**é æœŸçµæžœ**:
- è¨ºæ–·ä¿¡æ¯æº–ç¢ºåæ˜ ç•¶å‰ç‹€æ…‹
- è¨ºæ–·çµæžœèˆ‡å¯¦éš›ç‹€æ…‹ä¸€è‡´
- è¨ºæ–·ä¿¡æ¯å¹«åŠ©ç”¨æˆ¶ç†è§£å•é¡Œ

## ðŸš€ æ¸¬è©¦åŸ·è¡Œå‘½ä»¤

### é‹è¡Œæ‰€æœ‰ Threads ç›¸é—œæ¸¬è©¦
```bash
npm run test:threads
```

### é‹è¡Œå–®å…ƒæ¸¬è©¦
```bash
npm run test:unit
```

### é‹è¡Œ Netlify Functions æ¸¬è©¦
```bash
npm run test:netlify
```

### é‹è¡Œæ‰€æœ‰æ¸¬è©¦
```bash
npm run test:run
```

### ç”Ÿæˆæ¸¬è©¦è¦†è“‹çŽ‡å ±å‘Š
```bash
npm run test:coverage
```

## ðŸ“ æ¸¬è©¦ç¶­è­·èªªæ˜Ž

### æ·»åŠ æ–°æ¸¬è©¦
1. åœ¨å°æ‡‰çš„æ¸¬è©¦æ–‡ä»¶ä¸­æ·»åŠ æ–°çš„æ¸¬è©¦ç”¨ä¾‹
2. ç¢ºä¿æ¸¬è©¦è¦†è“‹æ–°çš„åŠŸèƒ½é‚è¼¯
3. é‹è¡Œæ¸¬è©¦é©—è­‰æ–°æ¸¬è©¦é€šéŽ

### æ›´æ–°ç¾æœ‰æ¸¬è©¦
1. ç•¶åŠŸèƒ½é‚è¼¯è®Šæ›´æ™‚ï¼Œæ›´æ–°å°æ‡‰çš„æ¸¬è©¦
2. ç¢ºä¿æ¸¬è©¦ä»ç„¶åæ˜ å¯¦éš›çš„è¡Œç‚º
3. é‹è¡Œæ¸¬è©¦é©—è­‰æ‰€æœ‰æ¸¬è©¦é€šéŽ

### æ¸¬è©¦æ•¸æ“šç®¡ç†
1. ä½¿ç”¨ `beforeEach` å’Œ `afterEach` æ¸…ç†æ¸¬è©¦ç‹€æ…‹
2. é¿å…æ¸¬è©¦ä¹‹é–“çš„ç‹€æ…‹æ±¡æŸ“
3. ä½¿ç”¨ mock æ•¸æ“šç¢ºä¿æ¸¬è©¦çš„ç¨ç«‹æ€§

## ðŸŽ¯ æ¸¬è©¦è³ªé‡æŒ‡æ¨™

- **æ¸¬è©¦è¦†è“‹çŽ‡**: ç›®æ¨™ > 90%
- **æ¸¬è©¦åŸ·è¡Œæ™‚é–“**: ç›®æ¨™ < 10 ç§’
- **æ¸¬è©¦ç©©å®šæ€§**: ç›®æ¨™ 100% é€šéŽçŽ‡
- **æ¸¬è©¦å¯ç¶­è­·æ€§**: æ¸…æ™°çš„æ¸¬è©¦çµæ§‹å’Œå‘½å

## ðŸ”§ æ•…éšœæŽ’é™¤

### å¸¸è¦‹æ¸¬è©¦å•é¡Œ
1. **Mock ä¾è³´å•é¡Œ**: æª¢æŸ¥ mock æ˜¯å¦æ­£ç¢ºè¨­ç½®
2. **ç•°æ­¥æ¸¬è©¦å•é¡Œ**: ä½¿ç”¨ `waitFor` è™•ç†ç•°æ­¥æ“ä½œ
3. **ç‹€æ…‹æ±¡æŸ“å•é¡Œ**: ç¢ºä¿æ¯å€‹æ¸¬è©¦éƒ½æœ‰æ­£ç¢ºçš„æ¸…ç†

### èª¿è©¦æŠ€å·§
1. ä½¿ç”¨ `console.log` è¼¸å‡ºæ¸¬è©¦ç‹€æ…‹
2. æª¢æŸ¥ mock å‡½æ•¸çš„èª¿ç”¨æ¬¡æ•¸å’Œåƒæ•¸
3. é©—è­‰æ¸¬è©¦ç’°å¢ƒè¨­ç½®æ˜¯å¦æ­£ç¢º
